# Lambda Functions
# docker-compose.yml からインクルードされる

services:
  # ============================================
  # Lambda Functions (Pre-loaded)
  # ============================================
  lambda-s3-test:
    image: lambda-s3-test:latest
    build:
      context: .
      dockerfile: lambda_functions/s3-test/Dockerfile
    container_name: lambda-s3-test
    environment:
      - S3_ENDPOINT=http://onpre-storage:9000
      - RUSTFS_ROOT_USER=${RUSTFS_ACCESS_KEY:-rustfsadmin}
      - RUSTFS_ROOT_PASSWORD=${RUSTFS_SECRET_KEY:-rustfsadmin}
    depends_on:
      s3-storage:
        condition: service_healthy
    restart: unless-stopped

  lambda-hello:
    image: lambda-hello:latest
    build:
      context: .
      dockerfile: lambda_functions/hello/Dockerfile
    container_name: lambda-hello
    restart: unless-stopped

  lambda-scylla-test:
    image: lambda-scylla-test:latest
    build:
      context: .
      dockerfile: lambda_functions/scylla-test/Dockerfile
    container_name: lambda-scylla-test
    environment:
      - DYNAMODB_ENDPOINT=http://onpre-database:8000
    depends_on:
      - database
    restart: unless-stopped

